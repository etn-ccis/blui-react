<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html><head><title>Coverity error reader: /Users/E0661236/Desktop/brightlayer-ui/blui-react/packages/login-workflow/src/screens/CreatePasswordScreen/CreatePasswordScreenBase.test.tsx</title><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head>
<body link="#000000" vlink="#000000"><pre>
<b><a name="line1">1    </a></b>	import React from 'react';
<b><a name="line2">2    </a></b>	import '@testing-library/jest-dom';
<b><a name="line3">3    </a></b>	import { cleanup, render, screen, fireEvent } from '@testing-library/react';
<b><a name="line4">4    </a></b>	import { CreatePasswordScreenBase } from './CreatePasswordScreenBase';
<b><a name="line5">5    </a></b>	import { SetPasswordProps } from '../../components';
<b><a name="line6">6    </a></b>	
<b><a name="line7">7    </a></b>	afterEach(cleanup);
<b><a name="line8">8    </a></b>	
<b><a name="line9">9    </a></b>	const defaultProps: SetPasswordProps = {
<b><a name="line10">10   </a></b>	    newPasswordLabel: '',
<b><a name="line11">11   </a></b>	    confirmPasswordLabel: '',
<b><a name="line12">12   </a></b>	    initialNewPasswordValue: '',
<b><a name="line13">13   </a></b>	    initialConfirmPasswordValue: '',
<b><a name="line14">14   </a></b>	    onPasswordChange: jest.fn(),
<b><a name="line15">15   </a></b>	};
<b><a name="line16">16   </a></b>	
<b><a name="line17">17   </a></b>	describe('Create Password Screen Base', () =&gt; {
<b><a name="line18">18   </a></b>	    let mockOnNext: any;
<b><a name="line19">19   </a></b>	    let mockOnPrevious: any;
<b><a name="line20">20   </a></b>	    let mockOnPasswordChange: any;
<b><a name="line21">21   </a></b>	
<b><a name="line22">22   </a></b>	    afterEach(() =&gt; {
<b><a name="line23">23   </a></b>	        jest.clearAllMocks();
<b><a name="line24">24   </a></b>	    });
<b><a name="line25">25   </a></b>	
<b><a name="line26">26   </a></b>	    beforeEach(() =&gt; {
<b><a name="line27">27   </a></b>	        mockOnNext = jest.fn();
<b><a name="line28">28   </a></b>	        mockOnPrevious = jest.fn();
<b><a name="line29">29   </a></b>	        mockOnPasswordChange = jest.fn();
<b><a name="line30">30   </a></b>	    });
<b><a name="line31">31   </a></b>	
<b><a name="line32">32   </a></b>	    it('renders without crashing', () =&gt; {
<b><a name="line33">33   </a></b>	        render(
<b><a name="line34">34   </a></b>	            &lt;CreatePasswordScreenBase
<b><a name="line35">35   </a></b>	                WorkflowCardHeaderProps={{ title: 'Create Password' }}
<b><a name="line36">36   </a></b>	                WorkflowCardInstructionProps={{
<b><a name="line37">37   </a></b>	                    instructions:
<b><a name="line38">38   </a></b>	                        'Please select a password. Make sure that your password meets the necessary complexity requirements outlined below.',
<b><a name="line39">39   </a></b>	                }}
<b><a name="line40">40   </a></b>	                PasswordProps={defaultProps}
<b><a name="line41">41   </a></b>	                WorkflowCardActionsProps={{
<b><a name="line42">42   </a></b>	                    showNext: true,
<b><a name="line43">43   </a></b>	                    nextLabel: 'Next',
<b><a name="line44">44   </a></b>	                    canGoNext: true,
<b><a name="line45">45   </a></b>	                    showPrevious: true,
<b><a name="line46">46   </a></b>	                    previousLabel: 'Back',
<b><a name="line47">47   </a></b>	                    canGoPrevious: true,
<b><a name="line48">48   </a></b>	                    currentStep: 2,
<b><a name="line49">49   </a></b>	                    totalSteps: 6,
<b><a name="line50">50   </a></b>	                    onNext: mockOnNext,
<b><a name="line51">51   </a></b>	                }}
<b><a name="line52">52   </a></b>	            /&gt;
<b><a name="line53">53   </a></b>	        );
<b><a name="line54">54   </a></b>	        expect(screen.getByText('Create Password')).toBeInTheDocument();
<b><a name="line55">55   </a></b>	        expect(
<b><a name="line56">56   </a></b>	            screen.getByText(
<b><a name="line57">57   </a></b>	                'Please select a password. Make sure that your password meets the necessary complexity requirements outlined below.'
<b><a name="line58">58   </a></b>	            )
<b><a name="line59">59   </a></b>	        ).toBeInTheDocument();
<b><a name="line60">60   </a></b>	        expect(screen.getByText('Next')).toBeInTheDocument();
<b><a name="line61">61   </a></b>	        expect(screen.getByText(/Next/i)).toBeEnabled();
<b><a name="line62">62   </a></b>	        expect(screen.getByText('Back')).toBeInTheDocument();
<b><a name="line63">63   </a></b>	        expect(screen.getByText(/Back/i)).toBeEnabled();
<b><a name="line64">64   </a></b>	    });
<b><a name="line65">65   </a></b>	
<b><a name="line66">66   </a></b>	    it('calls onNext when the next button is clicked', () =&gt; {
<b><a name="line67">67   </a></b>	        const { getByText } = render(
<b><a name="line68">68   </a></b>	            &lt;CreatePasswordScreenBase
<b><a name="line69">69   </a></b>	                PasswordProps={defaultProps}
<b><a name="line70">70   </a></b>	                WorkflowCardActionsProps={{
<b><a name="line71">71   </a></b>	                    onNext: mockOnNext,
<b><a name="line72">72   </a></b>	                    showNext: true,
<b><a name="line73">73   </a></b>	                    nextLabel: 'Next',
<b><a name="line74">74   </a></b>	                    canGoNext: true,
<b><a name="line75">75   </a></b>	                    currentStep: 2,
<b><a name="line76">76   </a></b>	                    totalSteps: 6,
<b><a name="line77">77   </a></b>	                }}
<b><a name="line78">78   </a></b>	            /&gt;
<b><a name="line79">79   </a></b>	        );
<b><a name="line80">80   </a></b>	
<b><a name="line81">81   </a></b>	        const nextButton = getByText('Next');
<b><a name="line82">82   </a></b>	        fireEvent.click(nextButton);
<b><a name="line83">83   </a></b>	
<b><a name="line84">84   </a></b>	        expect(mockOnNext).toHaveBeenCalled();
<b><a name="line85">85   </a></b>	    });
<b><a name="line86">86   </a></b>	
<b><a name="line87">87   </a></b>	    it('renders with minimal props', () =&gt; {
<b><a name="line88">88   </a></b>	        render(&lt;CreatePasswordScreenBase /&gt;);
<b><a name="line89">89   </a></b>	
<b><a name="line90">90   </a></b>	        // Component should render without crashing with no props
<b><a name="line91">91   </a></b>	        expect(document.body).toBeInTheDocument();
<b><a name="line92">92   </a></b>	    });
<b><a name="line93">93   </a></b>	
<b><a name="line94">94   </a></b>	    it('renders with custom WorkflowCardBaseProps', () =&gt; {
<b><a name="line95">95   </a></b>	        render(
<b><a name="line96">96   </a></b>	            &lt;CreatePasswordScreenBase
<b><a name="line97">97   </a></b>	                WorkflowCardBaseProps={{
<b><a name="line98">98   </a></b>	                    sx: { maxWidth: 400 },
<b><a name="line99">99   </a></b>	                    loading: true,
<b><a name="line100">100  </a></b>	                }}
<b><a name="line101">101  </a></b>	                PasswordProps={defaultProps}
<b><a name="line102">102  </a></b>	            /&gt;
<b><a name="line103">103  </a></b>	        );
<b><a name="line104">104  </a></b>	
<b><a name="line105">105  </a></b>	        // Component should render without errors
<b><a name="line106">106  </a></b>	        expect(document.body).toBeInTheDocument();
<b><a name="line107">107  </a></b>	    });
<b><a name="line108">108  </a></b>	    it('renders with errorDisplayConfig', () =&gt; {
<b><a name="line109">109  </a></b>	        render(
<b><a name="line110">110  </a></b>	            &lt;CreatePasswordScreenBase
<b><a name="line111">111  </a></b>	                errorDisplayConfig={{
<b><a name="line112">112  </a></b>	                    mode: 'dialog',
<b><a name="line113">113  </a></b>	                    error: 'Test error message',
<b><a name="line114">114  </a></b>	                    title: 'Error',
<b><a name="line115">115  </a></b>	                    onClose: jest.fn(),
<b><a name="line116">116  </a></b>	                }}
<b><a name="line117">117  </a></b>	                PasswordProps={defaultProps}
<b><a name="line118">118  </a></b>	            /&gt;
<b><a name="line119">119  </a></b>	        );
<b><a name="line120">120  </a></b>	
<b><a name="line121">121  </a></b>	        expect(screen.getByText('Test error message')).toBeInTheDocument();
<b><a name="line122">122  </a></b>	        expect(screen.getByText('Error')).toBeInTheDocument();
<b><a name="line123">123  </a></b>	    });
<b><a name="line124">124  </a></b>	
<b><a name="line125">125  </a></b>	    it('renders with errorDisplayConfig in message-box mode', () =&gt; {
<b><a name="line126">126  </a></b>	        render(
<b><a name="line127">127  </a></b>	            &lt;CreatePasswordScreenBase
<b><a name="line128">128  </a></b>	                errorDisplayConfig={{
<b><a name="line129">129  </a></b>	                    mode: 'message-box',
<b><a name="line130">130  </a></b>	                    error: 'Test error message',
<b><a name="line131">131  </a></b>	                    title: 'Warning',
<b><a name="line132">132  </a></b>	                    messageBoxConfig: {
<b><a name="line133">133  </a></b>	                        position: 'top',
<b><a name="line134">134  </a></b>	                        dismissible: true,
<b><a name="line135">135  </a></b>	                    },
<b><a name="line136">136  </a></b>	                }}
<b><a name="line137">137  </a></b>	                PasswordProps={defaultProps}
<b><a name="line138">138  </a></b>	            /&gt;
<b><a name="line139">139  </a></b>	        );
<b><a name="line140">140  </a></b>	
<b><a name="line141">141  </a></b>	        expect(screen.getByText('Test error message')).toBeInTheDocument();
<b><a name="line142">142  </a></b>	        expect(screen.getByText('Warning')).toBeInTheDocument();
<b><a name="line143">143  </a></b>	    });
<b><a name="line144">144  </a></b>	
<b><a name="line145">145  </a></b>	    it('renders with custom header props', () =&gt; {
<b><a name="line146">146  </a></b>	        render(
<b><a name="line147">147  </a></b>	            &lt;CreatePasswordScreenBase
<b><a name="line148">148  </a></b>	                WorkflowCardHeaderProps={{
<b><a name="line149">149  </a></b>	                    title: 'Custom Create Password Title',
<b><a name="line150">150  </a></b>	                    action: &lt;div data-testid=&quot;custom-action&quot;&gt;Action&lt;/div&gt;,
<b><a name="line151">151  </a></b>	                }}
<b><a name="line152">152  </a></b>	                PasswordProps={defaultProps}
<b><a name="line153">153  </a></b>	            /&gt;
<b><a name="line154">154  </a></b>	        );
<b><a name="line155">155  </a></b>	
<b><a name="line156">156  </a></b>	        expect(screen.getByText('Custom Create Password Title')).toBeInTheDocument();
<b><a name="line157">157  </a></b>	        expect(screen.getByTestId('custom-action')).toBeInTheDocument();
<b><a name="line158">158  </a></b>	    });
<b><a name="line159">159  </a></b>	    it('renders with custom instruction props', () =&gt; {
<b><a name="line160">160  </a></b>	        render(
<b><a name="line161">161  </a></b>	            &lt;CreatePasswordScreenBase
<b><a name="line162">162  </a></b>	                WorkflowCardInstructionProps={{
<b><a name="line163">163  </a></b>	                    instructions: 'Custom password instructions',
<b><a name="line164">164  </a></b>	                    sx: { color: 'primary.main' },
<b><a name="line165">165  </a></b>	                }}
<b><a name="line166">166  </a></b>	                PasswordProps={defaultProps}
<b><a name="line167">167  </a></b>	            /&gt;
<b><a name="line168">168  </a></b>	        );
<b><a name="line169">169  </a></b>	
<b><a name="line170">170  </a></b>	        expect(screen.getByText('Custom password instructions')).toBeInTheDocument();
<b><a name="line171">171  </a></b>	    });
<b><a name="line172">172  </a></b>	    it('renders with custom action props', () =&gt; {
<b><a name="line173">173  </a></b>	        render(
<b><a name="line174">174  </a></b>	            &lt;CreatePasswordScreenBase
<b><a name="line175">175  </a></b>	                WorkflowCardActionsProps={{
<b><a name="line176">176  </a></b>	                    showNext: true,
<b><a name="line177">177  </a></b>	                    nextLabel: 'Continue',
<b><a name="line178">178  </a></b>	                    canGoNext: false,
<b><a name="line179">179  </a></b>	                    showPrevious: true,
<b><a name="line180">180  </a></b>	                    previousLabel: 'Previous',
<b><a name="line181">181  </a></b>	                    canGoPrevious: true,
<b><a name="line182">182  </a></b>	                    currentStep: 3,
<b><a name="line183">183  </a></b>	                    totalSteps: 8,
<b><a name="line184">184  </a></b>	                    onNext: mockOnNext,
<b><a name="line185">185  </a></b>	                    onPrevious: mockOnPrevious,
<b><a name="line186">186  </a></b>	                }}
<b><a name="line187">187  </a></b>	                PasswordProps={defaultProps}
<b><a name="line188">188  </a></b>	            /&gt;
<b><a name="line189">189  </a></b>	        );
<b><a name="line190">190  </a></b>	
<b><a name="line191">191  </a></b>	        expect(screen.getByText('Continue')).toBeInTheDocument();
<b><a name="line192">192  </a></b>	        expect(screen.getByText('Previous')).toBeInTheDocument();
<b><a name="line193">193  </a></b>	        expect(screen.getByText('Continue')).toBeDisabled();
<b><a name="line194">194  </a></b>	        expect(screen.getByText('Previous')).toBeEnabled();
<b><a name="line195">195  </a></b>	    });
<b><a name="line196">196  </a></b>	
<b><a name="line197">197  </a></b>	    it('renders with comprehensive PasswordProps', () =&gt; {
<b><a name="line198">198  </a></b>	        const passwordProps: SetPasswordProps = {
<b><a name="line199">199  </a></b>	            newPasswordLabel: 'Enter New Password',
<b><a name="line200">200  </a></b>	            confirmPasswordLabel: 'Confirm Your Password',
<b><a name="line201">201  </a></b>	            initialNewPasswordValue: 'initial123',
<b><a name="line202">202  </a></b>	            initialConfirmPasswordValue: 'initial123',
<b><a name="line203">203  </a></b>	            passwordRequirements: [
<b><a name="line204">204  </a></b>	                {
<b><a name="line205">205  </a></b>	                    description: 'At least 8 characters',
<b><a name="line206">206  </a></b>	                    regex: /^.{8,}$/,
<b><a name="line207">207  </a></b>	                },
<b><a name="line208">208  </a></b>	                {
<b><a name="line209">209  </a></b>	                    description: 'Contains uppercase letter',
<b><a name="line210">210  </a></b>	                    regex: /[A-Z]/,
<b><a name="line211">211  </a></b>	                },
<b><a name="line212">212  </a></b>	                {
<b><a name="line213">213  </a></b>	                    description: 'Contains lowercase letter',
<b><a name="line214">214  </a></b>	                    regex: /[a-z]/,
<b><a name="line215">215  </a></b>	                },
<b><a name="line216">216  </a></b>	                {
<b><a name="line217">217  </a></b>	                    description: 'Contains number',
<b><a name="line218">218  </a></b>	                    regex: /\d/,
<b><a name="line219">219  </a></b>	                },
<b><a name="line220">220  </a></b>	            ],
<b><a name="line221">221  </a></b>	            passwordRef: React.createRef(),
<b><a name="line222">222  </a></b>	            confirmRef: React.createRef(),
<b><a name="line223">223  </a></b>	            passwordNotMatchError: 'Passwords do not match',
<b><a name="line224">224  </a></b>	            onPasswordChange: mockOnPasswordChange,
<b><a name="line225">225  </a></b>	            onSubmit: jest.fn(),
<b><a name="line226">226  </a></b>	        };
<b><a name="line227">227  </a></b>	
<b><a name="line228">228  </a></b>	        render(&lt;CreatePasswordScreenBase PasswordProps={passwordProps} /&gt;);
<b><a name="line229">229  </a></b>	
<b><a name="line230">230  </a></b>	        expect(screen.getByLabelText('Enter New Password')).toBeInTheDocument();
<b><a name="line231">231  </a></b>	        expect(screen.getByLabelText('Confirm Your Password')).toBeInTheDocument();
<b><a name="line232">232  </a></b>	    });
<b><a name="line233">233  </a></b>	
<b><a name="line234">234  </a></b>	    it('handles password change events', () =&gt; {
<b><a name="line235">235  </a></b>	        const passwordProps: SetPasswordProps = {
<b><a name="line236">236  </a></b>	            ...defaultProps,
<b><a name="line237">237  </a></b>	            newPasswordLabel: 'New Password',
<b><a name="line238">238  </a></b>	            confirmPasswordLabel: 'Confirm New Password',
<b><a name="line239">239  </a></b>	            onPasswordChange: mockOnPasswordChange,
<b><a name="line240">240  </a></b>	        };
<b><a name="line241">241  </a></b>	
<b><a name="line242">242  </a></b>	        render(&lt;CreatePasswordScreenBase PasswordProps={passwordProps} /&gt;);
<b><a name="line243">243  </a></b>	
<b><a name="line244">244  </a></b>	        const newPasswordInput = screen.getByLabelText('New Password');
<b><a name="line245">245  </a></b>	        const confirmPasswordInput = screen.getByLabelText('Confirm New Password');
<b><a name="line246">246  </a></b>	
<b><a name="line247">247  </a></b>	        fireEvent.change(newPasswordInput, { target: { value: 'newpassword123' } });
<b><a name="line248">248  </a></b>	        fireEvent.change(confirmPasswordInput, { target: { value: 'newpassword123' } });
<b><a name="line249">249  </a></b>	
<b><a name="line250">250  </a></b>	        expect(mockOnPasswordChange).toHaveBeenCalled();
<b><a name="line251">251  </a></b>	    });
<b><a name="line252">252  </a></b>	
<b><a name="line253">253  </a></b>	    it('renders with children', () =&gt; {
<b><a name="line254">254  </a></b>	        const { container } = render(
<b><a name="line255">255  </a></b>	            &lt;CreatePasswordScreenBase PasswordProps={defaultProps}&gt;
<b><a name="line256">256  </a></b>	                &lt;div data-testid=&quot;custom-child&quot;&gt;Custom child content&lt;/div&gt;
<b><a name="line257">257  </a></b>	            &lt;/CreatePasswordScreenBase&gt;
<b><a name="line258">258  </a></b>	        );
<b><a name="line259">259  </a></b>	
<b><a name="line260">260  </a></b>	        // Component should render without errors when children are provided
<b><a name="line261">261  </a></b>	        expect(container).toBeInTheDocument();
<b><a name="line262">262  </a></b>	    });
<b><a name="line263">263  </a></b>	    it('renders with otherProps spread to WorkflowCard', () =&gt; {
<b><a name="line264">264  </a></b>	        render(
<b><a name="line265">265  </a></b>	            &lt;CreatePasswordScreenBase
<b><a name="line266">266  </a></b>	                PasswordProps={defaultProps}
<b><a name="line267">267  </a></b>	                data-testid=&quot;workflow-card&quot;
<b><a name="line268">268  </a></b>	                sx={{ backgroundColor: 'primary.main' }}
<b><a name="line269">269  </a></b>	            /&gt;
<b><a name="line270">270  </a></b>	        );
<b><a name="line271">271  </a></b>	
<b><a name="line272">272  </a></b>	        const workflowCard = screen.getByTestId('workflow-card');
<b><a name="line273">273  </a></b>	        expect(workflowCard).toBeInTheDocument();
<b><a name="line274">274  </a></b>	    });
<b><a name="line275">275  </a></b>	    it('renders with undefined errorDisplayConfig', () =&gt; {
<b><a name="line276">276  </a></b>	        render(&lt;CreatePasswordScreenBase errorDisplayConfig={undefined} PasswordProps={defaultProps} /&gt;);
<b><a name="line277">277  </a></b>	
<b><a name="line278">278  </a></b>	        // Should render without errors when errorDisplayConfig is undefined
<b><a name="line279">279  </a></b>	        expect(document.body).toBeInTheDocument();
<b><a name="line280">280  </a></b>	    });
<b><a name="line281">281  </a></b>	
<b><a name="line282">282  </a></b>	    it('renders with empty errorDisplayConfig', () =&gt; {
<b><a name="line283">283  </a></b>	        render(&lt;CreatePasswordScreenBase errorDisplayConfig={{}} PasswordProps={defaultProps} /&gt;);
<b><a name="line284">284  </a></b>	
<b><a name="line285">285  </a></b>	        // Should render without errors when errorDisplayConfig is empty
<b><a name="line286">286  </a></b>	        expect(document.body).toBeInTheDocument();
<b><a name="line287">287  </a></b>	    });
<b><a name="line288">288  </a></b>	
<b><a name="line289">289  </a></b>	    it('calls onPrevious when previous button is clicked', () =&gt; {
<b><a name="line290">290  </a></b>	        render(
<b><a name="line291">291  </a></b>	            &lt;CreatePasswordScreenBase
<b><a name="line292">292  </a></b>	                PasswordProps={defaultProps}
<b><a name="line293">293  </a></b>	                WorkflowCardActionsProps={{
<b><a name="line294">294  </a></b>	                    showPrevious: true,
<b><a name="line295">295  </a></b>	                    previousLabel: 'Go Back',
<b><a name="line296">296  </a></b>	                    canGoPrevious: true,
<b><a name="line297">297  </a></b>	                    onPrevious: mockOnPrevious,
<b><a name="line298">298  </a></b>	                }}
<b><a name="line299">299  </a></b>	            /&gt;
<b><a name="line300">300  </a></b>	        );
<b><a name="line301">301  </a></b>	
<b><a name="line302">302  </a></b>	        const previousButton = screen.getByText('Go Back');
<b><a name="line303">303  </a></b>	        fireEvent.click(previousButton);
<b><a name="line304">304  </a></b>	
<b><a name="line305">305  </a></b>	        expect(mockOnPrevious).toHaveBeenCalled();
<b><a name="line306">306  </a></b>	    });
<b><a name="line307">307  </a></b>	
<b><a name="line308">308  </a></b>	    it('handles default PasswordProps when onPasswordChange is not provided', () =&gt; {
<b><a name="line309">309  </a></b>	        render(
<b><a name="line310">310  </a></b>	            &lt;CreatePasswordScreenBase
<b><a name="line311">311  </a></b>	                PasswordProps={{
<b><a name="line312">312  </a></b>	                    newPasswordLabel: 'New Password',
<b><a name="line313">313  </a></b>	                    confirmPasswordLabel: 'Confirm Password',
<b><a name="line314">314  </a></b>	                    initialNewPasswordValue: '',
<b><a name="line315">315  </a></b>	                    initialConfirmPasswordValue: '',
<b><a name="line316">316  </a></b>	                    // onPasswordChange is not provided, should use default
<b><a name="line317">317  </a></b>	                }}
<b><a name="line318">318  </a></b>	            /&gt;
<b><a name="line319">319  </a></b>	        );
<b><a name="line320">320  </a></b>	
<b><a name="line321">321  </a></b>	        expect(screen.getByLabelText('New Password')).toBeInTheDocument();
<b><a name="line322">322  </a></b>	        expect(screen.getByLabelText('Confirm Password')).toBeInTheDocument();
<b><a name="line323">323  </a></b>	    });
<b><a name="line324">324  </a></b>	
<b><a name="line325">325  </a></b>	    it('renders with all props as empty objects', () =&gt; {
<b><a name="line326">326  </a></b>	        render(
<b><a name="line327">327  </a></b>	            &lt;CreatePasswordScreenBase
<b><a name="line328">328  </a></b>	                WorkflowCardBaseProps={{}}
<b><a name="line329">329  </a></b>	                WorkflowCardInstructionProps={{}}
<b><a name="line330">330  </a></b>	                WorkflowCardActionsProps={{}}
<b><a name="line331">331  </a></b>	                WorkflowCardHeaderProps={{}}
<b><a name="line332">332  </a></b>	                PasswordProps={{}}
<b><a name="line333">333  </a></b>	                errorDisplayConfig={{}}
<b><a name="line334">334  </a></b>	            /&gt;
<b><a name="line335">335  </a></b>	        );
<b><a name="line336">336  </a></b>	
<b><a name="line337">337  </a></b>	        // Should render without crashing with all empty prop objects
<b><a name="line338">338  </a></b>	        expect(document.body).toBeInTheDocument();
<b><a name="line339">339  </a></b>	    });
<b><a name="line340">340  </a></b>	
<b><a name="line341">341  </a></b>	    it('renders without PasswordProps to test default assignment', () =&gt; {
<b><a name="line342">342  </a></b>	        render(&lt;CreatePasswordScreenBase /&gt;);
<b><a name="line343">343  </a></b>	
<b><a name="line344">344  </a></b>	        // Should render without crashing when PasswordProps is undefined
<b><a name="line345">345  </a></b>	        // This specifically tests the default assignment line: PasswordProps: passwordProps = { onPasswordChange: () =&gt; ({}) }
<b><a name="line346">346  </a></b>	        expect(document.body).toBeInTheDocument();
<b><a name="line347">347  </a></b>	    });
<b><a name="line348">348  </a></b>	
<b><a name="line349">349  </a></b>	    it('should call default onPasswordChange when PasswordProps is not provided', () =&gt; {
<b><a name="line350">350  </a></b>	        render(&lt;CreatePasswordScreenBase /&gt;);
<b><a name="line351">351  </a></b>	
<b><a name="line352">352  </a></b>	        // The component should render with the default onPasswordChange function
<b><a name="line353">353  </a></b>	        // This specifically covers the default function () =&gt; ({})
<b><a name="line354">354  </a></b>	        expect(document.body).toBeInTheDocument();
<b><a name="line355">355  </a></b>	    });
<b><a name="line356">356  </a></b>	
<b><a name="line357">357  </a></b>	    it('handles deep prop spreading with nested objects', () =&gt; {
<b><a name="line358">358  </a></b>	        const complexProps = {
<b><a name="line359">359  </a></b>	            WorkflowCardBaseProps: {
<b><a name="line360">360  </a></b>	                loading: true,
<b><a name="line361">361  </a></b>	                style: { backgroundColor: 'red' },
<b><a name="line362">362  </a></b>	                'data-testid': 'complex-workflow-card',
<b><a name="line363">363  </a></b>	            },
<b><a name="line364">364  </a></b>	            WorkflowCardHeaderProps: {
<b><a name="line365">365  </a></b>	                title: 'Complex Title',
<b><a name="line366">366  </a></b>	                subtitle: 'Complex Subtitle',
<b><a name="line367">367  </a></b>	                icon: &lt;div&gt;Icon&lt;/div&gt;,
<b><a name="line368">368  </a></b>	            },
<b><a name="line369">369  </a></b>	            WorkflowCardInstructionProps: {
<b><a name="line370">370  </a></b>	                instructions: 'Complex instructions with HTML',
<b><a name="line371">371  </a></b>	                divider: true,
<b><a name="line372">372  </a></b>	            },
<b><a name="line373">373  </a></b>	            WorkflowCardActionsProps: {
<b><a name="line374">374  </a></b>	                showNext: true,
<b><a name="line375">375  </a></b>	                showPrevious: true,
<b><a name="line376">376  </a></b>	                nextLabel: 'Continue',
<b><a name="line377">377  </a></b>	                previousLabel: 'Go Back',
<b><a name="line378">378  </a></b>	                canGoNext: true,
<b><a name="line379">379  </a></b>	                canGoPrevious: true,
<b><a name="line380">380  </a></b>	                fullWidthButton: true,
<b><a name="line381">381  </a></b>	            },
<b><a name="line382">382  </a></b>	            PasswordProps: {
<b><a name="line383">383  </a></b>	                newPasswordLabel: 'New Pass',
<b><a name="line384">384  </a></b>	                confirmPasswordLabel: 'Confirm Pass',
<b><a name="line385">385  </a></b>	                initialNewPasswordValue: 'initial123',
<b><a name="line386">386  </a></b>	                initialConfirmPasswordValue: 'confirm123',
<b><a name="line387">387  </a></b>	                passwordRequirements: [
<b><a name="line388">388  </a></b>	                    { description: 'At least 8 characters', regex: /.{8,}/ },
<b><a name="line389">389  </a></b>	                    { description: 'Contains number', regex: /\d/ },
<b><a name="line390">390  </a></b>	                ],
<b><a name="line391">391  </a></b>	                onPasswordChange: mockOnPasswordChange,
<b><a name="line392">392  </a></b>	            },
<b><a name="line393">393  </a></b>	            errorDisplayConfig: {
<b><a name="line394">394  </a></b>	                mode: 'message-box' as const,
<b><a name="line395">395  </a></b>	                title: 'Error occurred',
<b><a name="line396">396  </a></b>	            },
<b><a name="line397">397  </a></b>	        };
<b><a name="line398">398  </a></b>	
<b><a name="line399">399  </a></b>	        render(&lt;CreatePasswordScreenBase {...complexProps} /&gt;);
<b><a name="line400">400  </a></b>	
<b><a name="line401">401  </a></b>	        expect(screen.getByText('Complex Title')).toBeInTheDocument();
<b><a name="line402">402  </a></b>	        expect(screen.getByText('Complex instructions with HTML')).toBeInTheDocument();
<b><a name="line403">403  </a></b>	        expect(screen.getByLabelText('New Pass')).toBeInTheDocument();
<b><a name="line404">404  </a></b>	        expect(screen.getByLabelText('Confirm Pass')).toBeInTheDocument();
<b><a name="line405">405  </a></b>	    });
<b><a name="line406">406  </a></b>	
<b><a name="line407">407  </a></b>	    it('tests component function instantiation and execution', () =&gt; {
<b><a name="line408">408  </a></b>	        const componentFunction = CreatePasswordScreenBase;
<b><a name="line409">409  </a></b>	        expect(typeof componentFunction).toBe('function');
<b><a name="line410">410  </a></b>	
<b><a name="line411">411  </a></b>	        const props = {
<b><a name="line412">412  </a></b>	            PasswordProps: defaultProps,
<b><a name="line413">413  </a></b>	        };
<b><a name="line414">414  </a></b>	
<b><a name="line415">415  </a></b>	        const { container } = render(React.createElement(componentFunction, props));
<b><a name="line416">416  </a></b>	        expect(container.firstChild).toBeInTheDocument();
<b><a name="line417">417  </a></b>	    });
<b><a name="line418">418  </a></b>	
<b><a name="line419">419  </a></b>	    it('handles null and undefined prop values gracefully', () =&gt; {
<b><a name="line420">420  </a></b>	        // Test with properly typed empty/undefined props
<b><a name="line421">421  </a></b>	        render(&lt;CreatePasswordScreenBase /&gt;);
<b><a name="line422">422  </a></b>	        expect(document.body).toBeInTheDocument();
<b><a name="line423">423  </a></b>	
<b><a name="line424">424  </a></b>	        // Test with empty objects instead of null/undefined for better TypeScript compatibility
<b><a name="line425">425  </a></b>	        render(
<b><a name="line426">426  </a></b>	            &lt;CreatePasswordScreenBase
<b><a name="line427">427  </a></b>	                WorkflowCardBaseProps={{}}
<b><a name="line428">428  </a></b>	                WorkflowCardHeaderProps={{}}
<b><a name="line429">429  </a></b>	                WorkflowCardInstructionProps={{}}
<b><a name="line430">430  </a></b>	                WorkflowCardActionsProps={{}}
<b><a name="line431">431  </a></b>	                PasswordProps={{}}
<b><a name="line432">432  </a></b>	                errorDisplayConfig={{}}
<b><a name="line433">433  </a></b>	            /&gt;
<b><a name="line434">434  </a></b>	        );
<b><a name="line435">435  </a></b>	        expect(document.body).toBeInTheDocument();
<b><a name="line436">436  </a></b>	    });
<b><a name="line437">437  </a></b>	
<b><a name="line438">438  </a></b>	    it('covers default PasswordProps assignment execution path', () =&gt; {
<b><a name="line439">439  </a></b>	        // This test specifically targets the default assignment line
<b><a name="line440">440  </a></b>	        // PasswordProps: passwordProps = { onPasswordChange: () =&gt; ({}) }
<b><a name="line441">441  </a></b>	        const { container } = render(&lt;CreatePasswordScreenBase /&gt;);
<b><a name="line442">442  </a></b>	
<b><a name="line443">443  </a></b>	        // Verify the component renders which means the default assignment worked
<b><a name="line444">444  </a></b>	        expect(container.querySelector('[data-testid=&quot;password&quot;]')).toBeInTheDocument();
<b><a name="line445">445  </a></b>	
<b><a name="line446">446  </a></b>	        // Try to find password inputs to ensure SetPassword received the default props
<b><a name="line447">447  </a></b>	        const passwordInputs = container.querySelectorAll('input[type=&quot;password&quot;]');
<b><a name="line448">448  </a></b>	        expect(passwordInputs.length).toBeGreaterThan(0);
<b><a name="line449">449  </a></b>	    });
<b><a name="line450">450  </a></b>	
<b><a name="line451">451  </a></b>	    it('executes default onPasswordChange function', () =&gt; {
<b><a name="line452">452  </a></b>	        const { container } = render(&lt;CreatePasswordScreenBase /&gt;);
<b><a name="line453">453  </a></b>	
<b><a name="line454">454  </a></b>	        // Find password input and try to trigger change to call default onPasswordChange
<b><a name="line455">455  </a></b>	        const passwordInput = container.querySelector('input[type=&quot;password&quot;]');
<b><a name="line456">456  </a></b>	        if (passwordInput) {
<b><a name="line457">457  </a></b>	            fireEvent.change(passwordInput, { target: { value: 'test123' } });
<b><a name="line458">458  </a></b>	        }
<b><a name="line459">459  </a></b>	
<b><a name="line460">460  </a></b>	        // The component should still render without errors even with default function
<b><a name="line461">461  </a></b>	        expect(container.firstChild).toBeInTheDocument();
<b><a name="line462">462  </a></b>	    });
<b><a name="line463">463  </a></b>	
<b><a name="line464">464  </a></b>	    it('renders with complex children structure', () =&gt; {
<b><a name="line465">465  </a></b>	        const complexChildren = (
<b><a name="line466">466  </a></b>	            &lt;div data-testid=&quot;complex-children&quot;&gt;
<b><a name="line467">467  </a></b>	                &lt;span&gt;Child 1&lt;/span&gt;
<b><a name="line468">468  </a></b>	                &lt;div&gt;
<b><a name="line469">469  </a></b>	                    &lt;p&gt;Nested child&lt;/p&gt;
<b><a name="line470">470  </a></b>	                    &lt;button&gt;Child button&lt;/button&gt;
<b><a name="line471">471  </a></b>	                &lt;/div&gt;
<b><a name="line472">472  </a></b>	                &lt;ul&gt;
<b><a name="line473">473  </a></b>	                    &lt;li&gt;List item 1&lt;/li&gt;
<b><a name="line474">474  </a></b>	                    &lt;li&gt;List item 2&lt;/li&gt;
<b><a name="line475">475  </a></b>	                &lt;/ul&gt;
<b><a name="line476">476  </a></b>	            &lt;/div&gt;
<b><a name="line477">477  </a></b>	        );
<b><a name="line478">478  </a></b>	
<b><a name="line479">479  </a></b>	        render(&lt;CreatePasswordScreenBase PasswordProps={defaultProps}&gt;{complexChildren}&lt;/CreatePasswordScreenBase&gt;);
<b><a name="line480">480  </a></b>	
<b><a name="line481">481  </a></b>	        // Children should be rendered somewhere in the component
<b><a name="line482">482  </a></b>	        // Note: The children might be rendered by WorkflowCard but location may vary
<b><a name="line483">483  </a></b>	        const component = screen.getByTestId('BluiWorkflowCard-root');
<b><a name="line484">484  </a></b>	        expect(component).toBeInTheDocument();
<b><a name="line485">485  </a></b>	    });
<b><a name="line486">486  </a></b>	
<b><a name="line487">487  </a></b>	    it('tests component with maximum prop combinations', () =&gt; {
<b><a name="line488">488  </a></b>	        const maxProps = {
<b><a name="line489">489  </a></b>	            WorkflowCardBaseProps: {
<b><a name="line490">490  </a></b>	                loading: false,
<b><a name="line491">491  </a></b>	                style: { minHeight: '500px' },
<b><a name="line492">492  </a></b>	                className: 'custom-card-class',
<b><a name="line493">493  </a></b>	            },
<b><a name="line494">494  </a></b>	            WorkflowCardHeaderProps: {
<b><a name="line495">495  </a></b>	                title: 'Maximum Props Test',
<b><a name="line496">496  </a></b>	                subtitle: 'Testing all possible props',
<b><a name="line497">497  </a></b>	                onIconClick: jest.fn(),
<b><a name="line498">498  </a></b>	            },
<b><a name="line499">499  </a></b>	            WorkflowCardInstructionProps: {
<b><a name="line500">500  </a></b>	                instructions: 'Maximum instructions test',
<b><a name="line501">501  </a></b>	                divider: false,
<b><a name="line502">502  </a></b>	            },
<b><a name="line503">503  </a></b>	            WorkflowCardActionsProps: {
<b><a name="line504">504  </a></b>	                showNext: true,
<b><a name="line505">505  </a></b>	                showPrevious: true,
<b><a name="line506">506  </a></b>	                nextLabel: 'Next Step',
<b><a name="line507">507  </a></b>	                previousLabel: 'Previous Step',
<b><a name="line508">508  </a></b>	                canGoNext: false,
<b><a name="line509">509  </a></b>	                canGoPrevious: false,
<b><a name="line510">510  </a></b>	                onNext: mockOnNext,
<b><a name="line511">511  </a></b>	                onPrevious: mockOnPrevious,
<b><a name="line512">512  </a></b>	                currentStep: 3,
<b><a name="line513">513  </a></b>	                totalSteps: 5,
<b><a name="line514">514  </a></b>	            },
<b><a name="line515">515  </a></b>	            PasswordProps: {
<b><a name="line516">516  </a></b>	                newPasswordLabel: 'Create Password',
</pre>
<table summary="events" bgcolor=#e0e0e0>
<tr><td><font color="red">
<a name="error:0"></a>
<a name="error"></a>
<!-- merge-key 51830e1cb93455592b27c85cc97ea96d -->
<b>(1) Event Sigma main event</b>: </font></td>
<td><font color="red">A secret, such as a password, cryptographic key, or token is stored in plaintext directly in the source code, in an application's properties, or configuration file. Users with access to the secret may then use the secret to access resources that they otherwise would not have access to. Secret type: Password (generic).</font></td>
</tr>
<tr><td><font color="red">
<a name="error:1"></a>
<!-- merge-key 51830e1cb93455592b27c85cc97ea96d -->
<b>(2) Event remediation</b>: </font></td>
<td><font color="red">Avoid setting sensitive configuration values as string literals. Instead, these values should be set using variables with the sensitive data loaded from an encrypted file or a secret store.</font></td>
</tr>
</table>
<pre><b><a name="line517">517  </a></b>	                confirmPasswordLabel: 'Verify Password',
<b><a name="line518">518  </a></b>	                initialNewPasswordValue: 'preset123',
<b><a name="line519">519  </a></b>	                initialConfirmPasswordValue: 'preset123',
<b><a name="line520">520  </a></b>	                passwordRequirements: [
<b><a name="line521">521  </a></b>	                    { description: 'Min 12 chars', regex: /.{12,}/ },
<b><a name="line522">522  </a></b>	                    { description: 'Has uppercase', regex: /[A-Z]/ },
<b><a name="line523">523  </a></b>	                    { description: 'Has lowercase', regex: /[a-z]/ },
<b><a name="line524">524  </a></b>	                    { description: 'Has special char', regex: /[!@#$%^&amp;*]/ },
<b><a name="line525">525  </a></b>	                ],
<b><a name="line526">526  </a></b>	                onPasswordChange: mockOnPasswordChange,
<b><a name="line527">527  </a></b>	                passwordNotMatchError: 'Passwords must match exactly',
<b><a name="line528">528  </a></b>	            },
<b><a name="line529">529  </a></b>	            errorDisplayConfig: {
<b><a name="line530">530  </a></b>	                mode: 'dialog' as const,
<b><a name="line531">531  </a></b>	                title: 'Validation Error',
<b><a name="line532">532  </a></b>	                dismissible: true,
<b><a name="line533">533  </a></b>	                onClose: jest.fn(),
<b><a name="line534">534  </a></b>	            },
<b><a name="line535">535  </a></b>	        };
<b><a name="line536">536  </a></b>	
<b><a name="line537">537  </a></b>	        render(&lt;CreatePasswordScreenBase {...maxProps} /&gt;);
<b><a name="line538">538  </a></b>	
<b><a name="line539">539  </a></b>	        expect(screen.getByText('Maximum Props Test')).toBeInTheDocument();
<b><a name="line540">540  </a></b>	        // The subtitle is rendered as an attribute, check it's present in the DOM
<b><a name="line541">541  </a></b>	        const headerElement = screen.getByText('Maximum Props Test').closest('.MuiCardHeader-root');
<b><a name="line542">542  </a></b>	        expect(headerElement).toHaveAttribute('subtitle', 'Testing all possible props');
<b><a name="line543">543  </a></b>	        expect(screen.getByLabelText('Create Password')).toBeInTheDocument();
<b><a name="line544">544  </a></b>	        expect(screen.getByLabelText('Verify Password')).toBeInTheDocument();
<b><a name="line545">545  </a></b>	    });
<b><a name="line546">546  </a></b>	});
<b><a name="line547">547  </a></b>	


















































</pre></body>
</html>
