<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html><head><title>Coverity error reader: /Users/E0661236/Desktop/brightlayer-ui/blui-react/packages/login-workflow/src/components/SetPassword/SetPassword.test.tsx</title><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head>
<body link="#000000" vlink="#000000"><pre>
<b><a name="line1">1    </a></b>	import React from 'react';
<b><a name="line2">2    </a></b>	import '@testing-library/jest-dom';
<b><a name="line3">3    </a></b>	import { cleanup, fireEvent, render, RenderResult, screen } from '@testing-library/react';
<b><a name="line4">4    </a></b>	import { SetPassword } from './SetPassword';
<b><a name="line5">5    </a></b>	import { AuthContextProvider } from '../../contexts';
<b><a name="line6">6    </a></b>	import { PasswordRequirement, SetPasswordProps } from './types';
<b><a name="line7">7    </a></b>	import { authContextProviderProps } from '../../testUtils';
<b><a name="line8">8    </a></b>	
<b><a name="line9">9    </a></b>	afterEach(cleanup);
<b><a name="line10">10   </a></b>	
<b><a name="line11">11   </a></b>	const passwordRequirements: PasswordRequirement[] = [
<b><a name="line12">12   </a></b>	    {
<b><a name="line13">13   </a></b>	        description: 'Check 1',
<b><a name="line14">14   </a></b>	        regex: /^.{3,5}$/,
<b><a name="line15">15   </a></b>	    },
<b><a name="line16">16   </a></b>	    {
<b><a name="line17">17   </a></b>	        description: 'Check 2',
<b><a name="line18">18   </a></b>	        regex: /[a-z]+/,
<b><a name="line19">19   </a></b>	    },
<b><a name="line20">20   </a></b>	];
<b><a name="line21">21   </a></b>	
<b><a name="line22">22   </a></b>	const setPasswordProps: SetPasswordProps = {
<b><a name="line23">23   </a></b>	    newPasswordLabel: 'Password',
<b><a name="line24">24   </a></b>	    confirmPasswordLabel: 'Confirm Password',
<b><a name="line25">25   </a></b>	    initialNewPasswordValue: '',
<b><a name="line26">26   </a></b>	    initialConfirmPasswordValue: '',
</pre>
<table summary="events" bgcolor=#e0e0e0>
<tr><td><font color="red">
<a name="error:0"></a>
<a name="error"></a>
<!-- merge-key b0885c0e3c29ac634529aa6372ed180e -->
<b>(1) Event Sigma main event</b>: </font></td>
<td><font color="red">A secret, such as a password, cryptographic key, or token is stored in plaintext directly in the source code, in an application's properties, or configuration file. Users with access to the secret may then use the secret to access resources that they otherwise would not have access to. Secret type: Password (generic).</font></td>
</tr>
<tr><td><font color="red">
<a name="error:1"></a>
<!-- merge-key b0885c0e3c29ac634529aa6372ed180e -->
<b>(2) Event remediation</b>: </font></td>
<td><font color="red">Avoid setting sensitive configuration values as string literals. Instead, these values should be set using variables with the sensitive data loaded from an encrypted file or a secret store.</font></td>
</tr>
</table>
<pre><b><a name="line27">27   </a></b>	    passwordNotMatchError: 'Passwords do not match',
<b><a name="line28">28   </a></b>	    onPasswordChange: jest.fn(),
<b><a name="line29">29   </a></b>	    passwordRequirements: passwordRequirements,
<b><a name="line30">30   </a></b>	};
<b><a name="line31">31   </a></b>	
<b><a name="line32">32   </a></b>	const isValidPassword = (passwordInput: string): boolean =&gt; {
<b><a name="line33">33   </a></b>	    for (const req of passwordRequirements) {
<b><a name="line34">34   </a></b>	        if (!new RegExp(req.regex).test(passwordInput)) return false;
<b><a name="line35">35   </a></b>	    }
<b><a name="line36">36   </a></b>	    return true;
<b><a name="line37">37   </a></b>	};
<b><a name="line38">38   </a></b>	
<b><a name="line39">39   </a></b>	describe('SetPassword', () =&gt; {
<b><a name="line40">40   </a></b>	    const renderer = (props = setPasswordProps): RenderResult =&gt;
<b><a name="line41">41   </a></b>	        render(
<b><a name="line42">42   </a></b>	            &lt;AuthContextProvider {...authContextProviderProps}&gt;
<b><a name="line43">43   </a></b>	                &lt;SetPassword {...props} /&gt;
<b><a name="line44">44   </a></b>	            &lt;/AuthContextProvider&gt;
<b><a name="line45">45   </a></b>	        );
<b><a name="line46">46   </a></b>	
<b><a name="line47">47   </a></b>	    it('renders without crashing', () =&gt; {
<b><a name="line48">48   </a></b>	        renderer();
<b><a name="line49">49   </a></b>	
<b><a name="line50">50   </a></b>	        expect(screen.getByTestId('password')).toBeInTheDocument();
<b><a name="line51">51   </a></b>	        expect(screen.getByTestId('confirm')).toBeInTheDocument();
<b><a name="line52">52   </a></b>	    });
<b><a name="line53">53   </a></b>	
<b><a name="line54">54   </a></b>	    it('should display default props', () =&gt; {
<b><a name="line55">55   </a></b>	        renderer();
<b><a name="line56">56   </a></b>	
<b><a name="line57">57   </a></b>	        expect(screen.getByLabelText('Password')).toBeInTheDocument();
<b><a name="line58">58   </a></b>	        expect(screen.getByLabelText('Confirm Password')).toBeInTheDocument();
<b><a name="line59">59   </a></b>	        expect(screen.queryByLabelText('Password')).toBeEmptyDOMElement();
<b><a name="line60">60   </a></b>	        expect(screen.queryByLabelText('Confirm Password')).toBeEmptyDOMElement();
<b><a name="line61">61   </a></b>	    });
<b><a name="line62">62   </a></b>	
<b><a name="line63">63   </a></b>	    it('should display the passed props', () =&gt; {
<b><a name="line64">64   </a></b>	        const props = {
<b><a name="line65">65   </a></b>	            ...setPasswordProps,
<b><a name="line66">66   </a></b>	            newPasswordLabel: 'New Password',
<b><a name="line67">67   </a></b>	            confirmPasswordLabel: 'New Confirm Password',
<b><a name="line68">68   </a></b>	        };
<b><a name="line69">69   </a></b>	        renderer(props);
<b><a name="line70">70   </a></b>	
<b><a name="line71">71   </a></b>	        expect(screen.getByLabelText('New Password')).toBeInTheDocument();
<b><a name="line72">72   </a></b>	        expect(screen.getByLabelText('New Confirm Password')).toBeInTheDocument();
<b><a name="line73">73   </a></b>	    });
<b><a name="line74">74   </a></b>	
<b><a name="line75">75   </a></b>	    it('should display the updated password requirements, when passed through passwordRequirements', () =&gt; {
<b><a name="line76">76   </a></b>	        const props = { ...setPasswordProps, passwordRequirements };
<b><a name="line77">77   </a></b>	        renderer(props);
<b><a name="line78">78   </a></b>	
<b><a name="line79">79   </a></b>	        expect(screen.queryByText('8-16 Characters')).toBeNull();
<b><a name="line80">80   </a></b>	        expect(screen.getByText('Check 1')).toBeInTheDocument();
<b><a name="line81">81   </a></b>	        expect(screen.getByText('Check 2')).toBeInTheDocument();
<b><a name="line82">82   </a></b>	    });
<b><a name="line83">83   </a></b>	
<b><a name="line84">84   </a></b>	    it('should check the password requirements', () =&gt; {
<b><a name="line85">85   </a></b>	        const props = { ...setPasswordProps, passwordRequirements };
<b><a name="line86">86   </a></b>	        renderer(props);
<b><a name="line87">87   </a></b>	
<b><a name="line88">88   </a></b>	        expect(isValidPassword('123')).toBeFalsy();
<b><a name="line89">89   </a></b>	        expect(isValidPassword('A123')).toBeFalsy();
<b><a name="line90">90   </a></b>	        expect(isValidPassword('a123')).toBeTruthy();
<b><a name="line91">91   </a></b>	    });
<b><a name="line92">92   </a></b>	
<b><a name="line93">93   </a></b>	    it('should display the field error, when passwords do not match', () =&gt; {
<b><a name="line94">94   </a></b>	        const { getByLabelText, rerender } = renderer();
<b><a name="line95">95   </a></b>	
<b><a name="line96">96   </a></b>	        const passwordField = getByLabelText('Password');
<b><a name="line97">97   </a></b>	        const confirmPasswordField = getByLabelText('Confirm Password');
<b><a name="line98">98   </a></b>	
<b><a name="line99">99   </a></b>	        fireEvent.focus(passwordField);
<b><a name="line100">100  </a></b>	        fireEvent.change(passwordField, { target: { value: '1' } });
<b><a name="line101">101  </a></b>	        fireEvent.blur(passwordField);
<b><a name="line102">102  </a></b>	
<b><a name="line103">103  </a></b>	        fireEvent.focus(confirmPasswordField);
<b><a name="line104">104  </a></b>	        fireEvent.change(confirmPasswordField, { target: { value: '2' } });
<b><a name="line105">105  </a></b>	        fireEvent.blur(confirmPasswordField);
<b><a name="line106">106  </a></b>	
<b><a name="line107">107  </a></b>	        rerender(
<b><a name="line108">108  </a></b>	            &lt;AuthContextProvider {...authContextProviderProps}&gt;
<b><a name="line109">109  </a></b>	                &lt;SetPassword {...setPasswordProps} /&gt;
<b><a name="line110">110  </a></b>	            &lt;/AuthContextProvider&gt;
<b><a name="line111">111  </a></b>	        );
<b><a name="line112">112  </a></b>	
<b><a name="line113">113  </a></b>	        expect(screen.getByText('Passwords do not match')).toBeInTheDocument();
<b><a name="line114">114  </a></b>	    });
<b><a name="line115">115  </a></b>	
<b><a name="line116">116  </a></b>	    it('should display the green check icon, when passwords match', () =&gt; {
<b><a name="line117">117  </a></b>	        const props = { ...setPasswordProps };
<b><a name="line118">118  </a></b>	        props.passwordRequirements = [];
<b><a name="line119">119  </a></b>	        const { getByLabelText, getByTestId, queryByTestId, rerender } = renderer();
<b><a name="line120">120  </a></b>	
<b><a name="line121">121  </a></b>	        const passwordField = getByLabelText('Password');
<b><a name="line122">122  </a></b>	        const confirmPasswordField = getByLabelText('Confirm Password');
<b><a name="line123">123  </a></b>	
<b><a name="line124">124  </a></b>	        expect(queryByTestId('check')).toBeNull();
<b><a name="line125">125  </a></b>	
<b><a name="line126">126  </a></b>	        fireEvent.focus(passwordField);
<b><a name="line127">127  </a></b>	        fireEvent.change(passwordField, { target: { value: '2' } });
<b><a name="line128">128  </a></b>	        fireEvent.blur(passwordField);
<b><a name="line129">129  </a></b>	
<b><a name="line130">130  </a></b>	        fireEvent.focus(confirmPasswordField);
<b><a name="line131">131  </a></b>	        fireEvent.change(confirmPasswordField, { target: { value: '2' } });
<b><a name="line132">132  </a></b>	        fireEvent.blur(confirmPasswordField);
<b><a name="line133">133  </a></b>	
<b><a name="line134">134  </a></b>	        rerender(
<b><a name="line135">135  </a></b>	            &lt;AuthContextProvider {...authContextProviderProps}&gt;
<b><a name="line136">136  </a></b>	                &lt;SetPassword {...props} /&gt;
<b><a name="line137">137  </a></b>	            &lt;/AuthContextProvider&gt;
<b><a name="line138">138  </a></b>	        );
<b><a name="line139">139  </a></b>	
<b><a name="line140">140  </a></b>	        expect(getByTestId('check')).toBeInTheDocument();
<b><a name="line141">141  </a></b>	    });
<b><a name="line142">142  </a></b>	});
<b><a name="line143">143  </a></b>	


















































</pre></body>
</html>
